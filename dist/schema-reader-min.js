!function(){var e={},t={};Object.defineProperty(t,"__esModule",{value:!0});var i=function(e,t,i,a){this.type="SchemaReader",this.connection=e,this.isFetching=!0,this.batchSize="undefined"==typeof t?100:t,this.skipErrors="undefined"==typeof a,this.readRelWithUdefNames=!1,"function"==typeof i&&this.populate(i,a)};i.prototype={populate:function(e,t){this.preMetas=[],this.completeMetas={},this.nameBatches=[];var i=0,a=this.connection.describeGlobal();this.preMetas=a.getArray("sobjects");for(var s=0;s<this.preMetas.length;){for(var n=[],r=0;s<this.preMetas.length&&r<this.batchSize;s++,r++)n.push(this.preMetas[s].name);this.nameBatches.push(n)}for(var o=!1,h=!1,l=this,d=function(a){if(!h){if(o)return console.log(a),t(a),void(h=!0);i--,console.log(i),i<=0&&(l.isFetching=!1,e())}},f=function(e){l.skipErrors?console.log(e):(o=!0,t(e)),d(e)},s=0;s<this.nameBatches.length;s++)console.log("Batch : "+this.nameBatches[s]),i++,this.fetchCompleteMeta(this.nameBatches[s],d,f)},fetchCompleteMeta:function(e,t,i){var a=this,s=function(e){try{for(var s=0;s<e.length;s++)a.registerMeta(e[s])}catch(e){i(e)}finally{t()}};this.connection.describeSObjects(e,s,i)},registerMeta:function(e){this.completeMetas[e.name]=e},shallowReadFields:function(e){this.validateState();for(var t in this.completeMetas)if("term"===this.shallowReadMetaFieldsAbr(this.completeMetas[t],e))return"term"},shallowReadMetaFields:function(e,t,i,a){if(this.validateState(),"undefined"==typeof e.fields)return void console.log("The object has no fields defined");for(var s=0;s<e.fields.length;s++){var n=e.fields[s];if("undefined"!=typeof n){var r=i.slice(0);if(r.push(n),"term"===a(n,e,r,this))return"term"}}},shallowReadMetaFieldsAbr:function(e,t){var i={};return i[e.name]=!0,this.shallowReadMetaFields(e,i,[e],t)},deepReadFields:function(e){this.validateState();for(var t in this.completeMetas)if("term"===this.deepReadMetaFieldsAbr(this.completeMetas[t],e))return"term"},deepReadMetaFields:function(e,t,i,a){if(this.validateState(),1!=t[e.name]&&"undefined"!=typeof e.fields){t[e.name]=!0,0==i.length&&i.push(e);for(var s=0;s<e.fields.length;s++){var n=e.fields[s];if("undefined"!=typeof n){var r=i.slice(0);if(r.push(n),"term"===a(n,e,r,this))return"term";if("reference"===n.type)if(Array.isArray(n.referenceTo)){for(var o=0;o<n.referenceTo.length;o++)if("term"===this.deepReadMetaFields(this.completeMetas[n.referenceTo[o]],t,r,a))return"term"}else if("term"===this.deepReadMetaFields(this.completeMetas[n.referenceTo],t,r,a))return"term"}}}},deepReadMetaFieldsAbr:function(e,t){return this.deepReadMetaFields(e,[],[],t)},shallowReadChildRelationships:function(e){this.validateState();for(var t in this.completeMetas)if("term"===this.shallowReadMetaChildRelationshipsAbr(this.completeMetas[t],e))return"term"},shallowReadMetaChildRelationships:function(e,t,i,a){if(this.validateState(),"undefined"==typeof e.childRelationships)return void console.log("The object has no child relationships defined");for(var s=0;s<e.childRelationships.length;s++){var n=e.childRelationships[s];if("undefined"!=typeof n){var r=i.slice(0);if(r.push(n),"term"===a(n,e,r,this))return"term"}}},shallowReadMetaChildRelationshipsAbr:function(e,t){var i={};return i[e.name]=!0,this.shallowReadMetaChildRelationships(e,i,[e],t)},validateState:function(){if(this.isFetching)throw this.type+" hasn't finished fetching metadata from the server"},createFilterVisitor:function(e,t){return function(i,a,s,n){e(i,a,s,n)&&t(i,a,s,n)}},newObjectNameFilter:function(e,t,i){return function(a,s,n,r){(!i&&e.toLowerCase()===s.name.toLowerCase()||i&&e===s.name)&&t(a,s,n,r)}},newFieldNameFilter:function(e,t,i){return function(a,s,n,r){(!i&&e.toLowerCase()===a.name.toLowerCase()||i&&e===a.name)&&t(a,s,n,r)}},newObjectAndFieldNameFilter:function(e,t,i,a){return function(s,n,r,o){(!a&&e.toLowerCase()===s.name.toLowerCase()||a&&e===s.name)&&(!a&&t.toLowerCase()===n.name.toLowerCase()||a&&t===n.name)&&i(s,n,r,o)}}},t.default=i,e.exports=t.default,window.SchemaReader=i}();
//# sourceMappingURL=schema-reader-min.map